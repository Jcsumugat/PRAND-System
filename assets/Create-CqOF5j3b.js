import{u as v,r as y,j as e,H as w}from"./app-DwwepQXc.js";import{A as k}from"./AuthenticatedLayout-B9VMHvEK.js";import{I as i,T as x}from"./TextInput-B1T-Y-TI.js";import{I as o}from"./InputLabel-ChzEKD-s.js";function E({deceasedRecords:m=[],selectedDeceased:d=null}){const{data:r,setData:t,post:g,processing:p,errors:a,reset:h}=v({deceased_record_id:d?.id||"",recipient_name:d?.next_of_kin_name||"",recipient_number:d?.contact_number||"",message:"",notice_type:"general"}),[n,b]=y.useState(0),l=160,j=s=>{s.preventDefault(),g(route("notices.store"),{onSuccess:()=>h()})},u=s=>{t("message",s),b(s.length)},N=s=>{t("deceased_record_id",s);const c=m.find(_=>_.id===parseInt(s));c&&t({...r,deceased_record_id:s,recipient_name:c.next_of_kin_name,recipient_number:c.contact_number})},f={payment_reminder:`Dear ${r.recipient_name}, this is a reminder about the upcoming payment for the tomb at our cemetery. Please settle the payment as soon as possible. Thank you.`,renewal_notice:`Dear ${r.recipient_name}, your tomb renewal is due. Please contact us or visit the office to process your renewal. Thank you.`,overdue_notice:`Dear ${r.recipient_name}, your payment is now overdue. Please settle your account immediately to avoid penalties. Thank you.`,general:""};return e.jsxs(k,{children:[e.jsx(w,{title:"Send Notice"}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-200 to-pink-200 rounded-xl shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"SEND NOTICE"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Distribute SMS notifications to recipients"})]}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl shadow-lg p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-700 mb-4 border-b pb-2",children:"DECEASED INFORMATION"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(o,{htmlFor:"deceased_record_id",value:"Select Deceased (Optional)",className:"text-gray-700 font-semibold"}),e.jsxs("select",{id:"deceased_record_id",value:r.deceased_record_id,className:"mt-1 block w-full bg-purple-50 border border-purple-200 rounded-md shadow-sm focus:border-purple-500 focus:ring-purple-500 px-3 py-2",onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"",children:"-- Choose a deceased record --"}),m.map(s=>e.jsxs("option",{value:s.id,children:[s.fullname," (Tomb: ",s.tomb_number,") - NK: ",s.next_of_kin_name]},s.id))]}),e.jsx(i,{message:a.deceased_record_id,className:"mt-2"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-700 mb-4 border-b pb-2",children:"RECIPIENT INFORMATION"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"recipient_name",value:"Recipient Name *",className:"text-gray-700 font-semibold"}),e.jsx(x,{id:"recipient_name",type:"text",value:r.recipient_name,className:"mt-1 block w-full bg-purple-50 border-purple-200 focus:border-purple-500 focus:ring-purple-500",onChange:s=>t("recipient_name",s.target.value),placeholder:"Enter recipient name",required:!0}),e.jsx(i,{message:a.recipient_name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"recipient_number",value:"Phone Number (Mobile) *",className:"text-gray-700 font-semibold"}),e.jsx(x,{id:"recipient_number",type:"text",value:r.recipient_number,className:"mt-1 block w-full bg-purple-50 border-purple-200 focus:border-purple-500 focus:ring-purple-500",onChange:s=>t("recipient_number",s.target.value),placeholder:"09123456789",required:!0}),e.jsx(i,{message:a.recipient_number,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-700 mb-4 border-b pb-2",children:"NOTICE DETAILS"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"notice_type",value:"Notice Type *",className:"text-gray-700 font-semibold"}),e.jsxs("select",{id:"notice_type",value:r.notice_type,className:"mt-1 block w-full bg-purple-50 border border-purple-200 rounded-md shadow-sm focus:border-purple-500 focus:ring-purple-500 px-3 py-2",onChange:s=>{t("notice_type",s.target.value),s.target.value!=="general"&&u(f[s.target.value])},required:!0,children:[e.jsx("option",{value:"general",children:"General Notice"}),e.jsx("option",{value:"payment_reminder",children:"Payment Reminder"}),e.jsx("option",{value:"renewal_notice",children:"Renewal Notice"}),e.jsx("option",{value:"overdue_notice",children:"Overdue Notice"})]}),e.jsx(i,{message:a.notice_type,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(o,{htmlFor:"message",value:"Message *",className:"text-gray-700 font-semibold"}),e.jsxs("span",{className:`text-xs font-semibold ${n>l?"text-red-600":"text-gray-600"}`,children:[n,"/",l]})]}),e.jsx("textarea",{id:"message",value:r.message,className:"mt-1 block w-full bg-purple-50 border border-purple-200 rounded-md shadow-sm focus:border-purple-500 focus:ring-purple-500 px-3 py-2",onChange:s=>u(s.target.value),rows:"4",placeholder:"Enter your message here (max 160 characters for SMS)",required:!0}),n>l&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Message exceeds SMS character limit. It may be sent as multiple messages."}),e.jsx(i,{message:a.message,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-6 border-2 border-purple-300",children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-900 mb-3",children:"Message Preview"}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border-l-4 border-purple-600",children:[e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:r.message||"Your message will appear here..."}),e.jsxs("div",{className:"flex justify-between items-center mt-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["To: ",r.recipient_number]}),e.jsxs("span",{className:n>l?"text-red-600 font-bold":"",children:[Math.ceil(n/l)," SMS"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-3 bg-gray-500 text-white font-semibold rounded-lg hover:bg-gray-600 transition shadow-md",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:p,className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-lg hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 transition shadow-md",children:p?"Sending Notice...":"Send Notice"})]})]})})]})]})}export{E as default};
